{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ASHWAK\\\\Downloads\\\\p2\\\\Realtime-chat-app-using-nodejs-master\\\\client\\\\src\\\\components\\\\Chat.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport queryString from 'query-string';\nimport io from 'socket.io-client';\nimport InfoBar from './InfoBar';\nimport Input from './Input';\nimport Messages from './Messages';\nimport TextContainer from './TextContainer';\nimport '../index.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet socket;\nconst Chat = _ref => {\n  _s();\n  let {\n    location\n  } = _ref;\n  const [name, setName] = useState('');\n  const [room, setRoom] = useState('');\n  const [message, setMessage] = useState('');\n  const [messages, setMessages] = useState([]);\n  const [users, setUsers] = useState('');\n  const history = useHistory();\n  const socketUrl = 'https://chatapp-in.herokuapp.com/';\n  useEffect(() => {\n    const {\n      name,\n      room\n    } = queryString.parse(location.search);\n    setName(name);\n    setRoom(room);\n    socket = io(socketUrl, {\n      transports: ['websocket', 'polling', 'flashsocket']\n    });\n    socket.emit('USER_ADDED', {\n      name,\n      room\n    }, err => {\n      if (err) {\n        alert(err);\n        history.push('/');\n      }\n    });\n    return () => {\n      socket.emit('disconnected');\n      //socket.off();\n    };\n  }, [socketUrl, location.search]);\n  useEffect(() => {\n    socket.on('MESSAGE', message => {\n      setMessages([...messages, message]);\n    });\n    socket.on('ROOM_DATA', _ref2 => {\n      let {\n        users\n      } = _ref2;\n      setUsers(users);\n    });\n  }, [messages]);\n  const sendMessage = e => {\n    e.preventDefault();\n    if (message) {\n      socket.emit('NEW_MESSAGE', message, () => setMessage(''));\n    }\n  };\n  console.log(messages);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"outerContainer\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(InfoBar, {\n        room: room\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Messages, {\n        messages: messages,\n        name: name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Input, {\n        message: message,\n        setMessage: setMessage,\n        sendMessage: sendMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(TextContainer, {\n      users: users\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 9\n  }, this);\n};\n_s(Chat, \"H9Rj1gvbfq3Jc2zkTCPUObnZnkc=\", false, function () {\n  return [useHistory];\n});\n_c = Chat;\nexport default Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useEffect","useState","useHistory","queryString","io","InfoBar","Input","Messages","TextContainer","socket","Chat","location","name","setName","room","setRoom","message","setMessage","messages","setMessages","users","setUsers","history","socketUrl","parse","search","transports","emit","err","alert","push","on","sendMessage","e","preventDefault","console","log"],"sources":["C:/Users/ASHWAK/Downloads/p2/Realtime-chat-app-using-nodejs-master/client/src/components/Chat.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport queryString from 'query-string';\nimport io from 'socket.io-client';\n\nimport InfoBar from './InfoBar';\nimport Input from './Input';\nimport Messages from './Messages';\nimport TextContainer from './TextContainer';\nimport '../index.css';\n\nlet socket;\n\nconst Chat = ({ location }) => {\n    const [name, setName] = useState('');\n    const [room, setRoom] = useState('');\n    const [message, setMessage] = useState('');\n    const [messages, setMessages] = useState([]);\n    const [users, setUsers] = useState('');\n    const history = useHistory();\n\n    const socketUrl = 'https://chatapp-in.herokuapp.com/';\n\n    useEffect (() => {\n        const { name, room } = queryString.parse(location.search);\n        setName(name);\n        setRoom(room);\n\n        socket = io(socketUrl,{transports: ['websocket', 'polling', 'flashsocket']});\n        socket.emit('USER_ADDED', { name, room }, (err) => {\n            if (err) {\n                alert(err);\n                history.push('/');\n            }\n        });\n\n        return () => {\n            socket.emit('disconnected');\n            //socket.off();\n        }\n    }, [socketUrl, location.search]);\n\n    useEffect (() => {\n        socket.on('MESSAGE', (message) => {\n            setMessages([...messages, message]);\n        });\n\n        socket.on('ROOM_DATA', ({users}) => {\n            setUsers(users);\n        })\n    }, [messages]);\n\n    const sendMessage = (e) => {\n        e.preventDefault();\n\n        if (message) {\n            socket.emit('NEW_MESSAGE', message, () => setMessage(''));\n        }\n    }\n\n    console.log(messages);\n\n    return (\n        <div className = \"outerContainer\">\n            <div className = \"container\">\n                <InfoBar room = {room}/>\n                <Messages messages = {messages} name = {name}/>\n                <Input message = {message} setMessage = {setMessage} sendMessage = {sendMessage} />\n            </div>\n            <TextContainer users = {users} />\n        </div>\n    );\n}\n\nexport default Chat;"],"mappings":"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"},"metadata":{},"sourceType":"module"}